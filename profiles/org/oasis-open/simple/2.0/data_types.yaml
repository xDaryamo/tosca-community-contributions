##########################################################################
# This file contains TOSCA Simple Profile data type
# definitions.
##########################################################################

tosca_definitions_version: tosca_2_0

metadata:
  template_name: data_types.yaml
  template_author: Oasis Open
  template_version: "2.0"

description: >
  TOSCA Simple Profile data type definitions

data_types:

  json:
    description: >-
      The json type defines strings that contain data in the
      JavaScript Object Notation (JSON) format.
    derived_from: string
#
# https://stackoverflow.com/questions/2583472/regex-to-validate-json
#    constraints:
#      - pattern: "/\
#                  (?(DEFINE)\
#                  (?<number>   -? (?= [1-9]|0(?!\\d) ) \\d+ (\\.\\d+)? ([eE] [+-]? \\d+)? )\
#                  (?<boolean>   true | false | null )\
#                  (?<string>    \" ([^\"\\\\\\\\]* | \\\\\\\\ [\"\\\\\\\\bfnrt\\/] | \\\\\\\\ u [0-9a-f]{4} )* \" )\
#                  (?<array>     \\[  (?:  (?&json)  (?: , (?&json)  )*  )?  \\s* \\] )\
#                  (?<pair>      \\s* (?&string) \\s* : (?&json)  )\
#                  (?<object>    \\{  (?:  (?&pair)  (?: , (?&pair)  )*  )?  \\s* \\} )\
#                  (?<json>   \\s* (?: (?&number) | (?&boolean) | (?&string) | (?&array) | (?&object) ) \\s* )\
#                  )\
#                  \\A (?&json) \\Z\
#                  /six"


  xml:
    description: >-
      The xml type defines strings that contain data in the Extensible
      Markup Language (XML) format.
    derived_from: string

  Credential:
    description: >-
      The Credential type describes authorization credentials used to
      access network-accessible resources.
    properties:
      protocol:
        description: >-
          The optional protocol name.
        type: string
        required: false
      token_type:
        description: >-
          The required token type.
        type: string
        default: password
      token:
        description: >-
          The required token used as a credential for authorization or
          access to a networked resource.
        type: string
      keys:
        description: >-
          The optional list of protocol-specific keys or assertions.
        type: map
        required: false
        entry_schema:
          type: string
      user:
        description: >-
          The optional user (name or ID) used for non-token-based
          credentials.
        type: string
        required: false

  TimeInterval:
    properties:
      start_time:
        type: timestamp
        required: true
      end_time:
        type: timestamp
        required: true

  NetworkInfo:
    description: >-
      The Network type describes logical network information.
    properties:
      network_name:
        description: >-
          The name of the logical network (e.g., “public”, “private”,
          “admin”. etc.).
        type: string
      network_id:
        description: >-
          The unique ID of the network generated by the network provider.
        type: string
      addresses:
        description: >-
          The list of IP addresses assigned from the underlying network.
        type: list
        entry_schema:
          type: string

  PortInfo:
    description: >-
      The PortInfo type describes network port information.
    properties:
      port_name:
        description: >-
          The logical network port name.
        type: string
      port_id:
        description: >-
          The unique ID for the network port generated by the network provider.
        type: string
      network_id:
        description: >-
          The unique ID for the network.
        type: string
      mac_address:
        description: >-
          The unique media access control (MAC) address assigned to the port.
        type: string
      addresses:
        description: >-
          The list of IP addresses assigned to the port.
        type: list
        entry_schema:
          type: string

  PortDef:
    description: >-
      The PortDef type defines a network port.
    derived_from: integer
    validation:
      $in_range: 
        - $value
        - [ 1, 65535 ]
  ##########################
  # SCALAR TYPE EXTENSIONS #
  ##########################

  Size:
    description: Scalar representing size values
    derived_from: scalar
    data_type: integer
    units:
      B: 1
      kB: 1000
      KB: 1000
      KiB: 1024
      MB: 1000000
      MiB: 1048576
      GB: 1000000000
      GiB: 1073741824
      TB: 1000000000000
      TiB: 1099511627776
    canonical_unit: B
    validation:
      $greater_or_equal: [ $value, 0 ]

  Time:
    description: Scalar representing durations
    derived_from: scalar
    data_type: float
    units:
      ns: 0.000000001
      us: 0.000001
      μs: 0.000001
      ms: 0.001
      s: 1
      m: 60
      h: 3600
      d: 86400
    canonical_unit: s
    validation:
      $greater_or_equal: [ $value, 0.0 ]

  Frequency:
    description: Scalar representing frequency values
    derived_from: scalar
    data_type: float
    units:
      Hz: 1
      kHz: 1000
      MHz: 1000000
      GHz: 1000000000
    canonical_unit: Hz
    validation:
      $greater_or_equal: [ $value, 0.0 ]

  Bitrate:
    description: Scalar representing bitrate values
    derived_from: scalar
    data_type: float
    units:
      bps: 1
      Bps: 8
      Kbps: 1000
      KBps: 8000
      Mbps: 1000000
      MBps: 8000000
      Kibps: 1024
      KiBps: 8192
      Mibps: 1048576
      MiBps: 8388608
    canonical_unit: bps
    validation:
      $greater_or_equal: [ $value, 0.0 ]
  PortSpec:
    description: >-
      The PortSpec type is used when describing port specifications
      for a network connection.
    properties:
      protocol:
        description: >-
          The required protocol used on the port.
        type: string
        required: true
        default: tcp
        validation:
          $valid_values: 
            - $value
            - [ udp, tcp, igmp ]
      target:
        description: >-
          The optional target port.
        type: PortDef
        required: false
      target_range:
        description: >-
          The optional range for target port.
        type: range
        required: false
        validation:
          $in_range: 
            - $value
            - [ 1, 65535 ]
      source:
        description: >-
          The optional source port.
        type: PortDef
        required: false
      source_range:
        description: >-
          The optional range for source port.
        type: range
        required: false
        validation:
          $in_range: 
            - $value
            - [ 1, 65535 ]
